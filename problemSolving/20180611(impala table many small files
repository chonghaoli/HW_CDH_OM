这种大量小文件的情况很可能是由于两个因素促成的：
1.	生成的表格较小，故文件自身也不大。这次的例子中，user_n00173705.PR00_MBB_CHURN_SUMMARY_OPER这张表只有671行。
2.	大集群节点有超过两百个节点，且源表文件分布的比较散。在query执行过程中，使用了大量instance。这导致query在多个机器上并行执行的过程中也产生了大量HDFS零散文件。

如果想要强制只生产少量的大文件，可以在运行query前在输入如下设置，然后重新创建新表，并将数据输入插入新表：
set num_nodes=1;
这会强制让impala进入单节点运行模式。这种情况下如果表较小，那么就只会生成一个HDFS文件。其中的一份HDFS文件就会被放在执行这条query的impala daemon所在的机器上。

执行如下命令关闭单节点模式：
set num_nodes=0;
